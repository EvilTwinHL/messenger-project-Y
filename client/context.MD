# üóÇ MESSENGER Y ‚Äî PROJECT CONTEXT
> –í—Å—Ç–∞–≤–ª—è–π —Ü–µ–π —Ñ–∞–π–ª –ø–µ—Ä—à–∏–º –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º —É –Ω–æ–≤–æ–º—É —á–∞—Ç—ñ.
> –ü—ñ—Å–ª—è —Ü—å–æ–≥–æ –¥–æ–¥–∞–≤–∞–π –ª–∏—à–µ —Ç–æ–π —Ñ–∞–π–ª, –∑ —è–∫–∏–º –∑–∞—Ä–∞–∑ –ø—Ä–∞—Ü—é—î—à.

---

## üì¶ –°–¢–ï–ö

| –®–∞—Ä | –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—è |
|-----|-----------|
| –ö–ª—ñ—î–Ω—Ç | Flutter 3.x (Android, iOS, Windows) |
| –°–µ—Ä–≤–µ—Ä | Node.js + Express 5 + Socket.IO 4.8 |
| –ë–î | Firebase Firestore (–ø—ñ–¥–∫–æ–ª–µ–∫—Ü—ñ—ó) |
| –°—Ö–æ–≤–∏—â–µ | Firebase Storage (Google Cloud) |
| Push | FCM multicast |
| Auth | –ù—ñ–∫–Ω–µ–π–º + –∞–≤–∞—Ç–∞—Ä (JWT ‚Äî —â–µ –Ω–µ –¥–æ–¥–∞–Ω–æ) |
| OTA | Shorebird Code Push |
| Real-time | Socket.IO rooms + Cloud Firestore StreamBuilder |

---

## üóÇ –°–¢–†–£–ö–¢–£–†–ê –§–ê–ô–õ–Ü–í

```
client/
‚îî‚îÄ‚îÄ lib/
    ‚îú‚îÄ‚îÄ main.dart                  # –¢–æ—á–∫–∞ –≤—Ö–æ–¥—É, MyApp, ChatScreen, LoginScreen (–ü–û–¢–†–Ü–ë–ù–û –†–û–ó–ë–ò–¢–ò)
    ‚îú‚îÄ‚îÄ home_screen.dart           # HomeScreen, _OvalNavBar, –≤–∫–ª–∞–¥–∫–∏ –ß–∞—Ç–∏/–ö–æ–Ω—Ç–∞–∫—Ç–∏/–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è/–ê–∫–∞—É–Ω—Ç
    ‚îú‚îÄ‚îÄ login_screen.dart          # LoginScreen (—î –¥—É–±–ª—ñ–∫–∞—Ç —É main.dart ‚Äî —Ü–µ –±–∞–≥)
    ‚îú‚îÄ‚îÄ search_screen.dart         # SearchUserScreen ‚Äî –ø–æ—à—É–∫ —é–∑–µ—Ä—ñ–≤, —Å—Ç–∞—Ä—Ç DM
    ‚îú‚îÄ‚îÄ settings_screen.dart       # SettingsScreen ‚Äî OTA, –ø—Ä–æ—Ñ—ñ–ª—å, —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è, logout
    ‚îú‚îÄ‚îÄ signal_context_menu.dart   # SignalContextMenu ‚Äî overlay –∑ —Ä–µ–∞–∫—Ü—ñ—è–º–∏ —Ç–∞ –¥—ñ—è–º–∏
    ‚îú‚îÄ‚îÄ audio_player_widget.dart   # AudioMessagePlayer ‚Äî waveform –ø–ª–µ—î—Ä Signal-—Å—Ç–∏–ª—å
    ‚îú‚îÄ‚îÄ voice_recorder.dart        # VoiceRecorder widget ‚Äî –∑–∞–ø–∏—Å –∑ –∞–Ω—ñ–º–∞—Ü—ñ—î—é (–æ–∫—Ä–µ–º–∏–π —Ñ–∞–π–ª)
    ‚îî‚îÄ‚îÄ theme.dart                 # SignalColors, AppSizes, AppTheme ‚Äî –í–°–Ü —Ç–æ–∫–µ–Ω–∏ —Ç—É—Ç

server/
‚îî‚îÄ‚îÄ index.js                      # Express + Socket.IO + Firebase Admin ‚Äî –≤–µ—Å—å —Å–µ—Ä–≤–µ—Ä –≤ –æ–¥–Ω–æ–º—É —Ñ–∞–π–ª—ñ
```

### –©–æ –©–ï –ü–û–¢–†–Ü–ë–ù–û —Å—Ç–≤–æ—Ä–∏—Ç–∏ (—Ç–µ—Ö–Ω—ñ—á–Ω–∏–π –±–æ—Ä–≥):
```
client/lib/
    ‚îú‚îÄ‚îÄ screens/                   # –ü–µ—Ä–µ–º—ñ—Å—Ç–∏—Ç–∏ ChatScreen, HomeScreen, LoginScreen —Å—é–¥–∏
    ‚îú‚îÄ‚îÄ widgets/                   # MessageBubble, SwipeToReply, TypingIndicator, DateSeparator
    ‚îú‚îÄ‚îÄ services/
    ‚îÇ   ‚îú‚îÄ‚îÄ socket_service.dart    # –Ü–Ω–∫–∞–ø—Å—É–ª—é–≤–∞—Ç–∏ Socket.IO –ª–æ–≥—ñ–∫—É
    ‚îÇ   ‚îî‚îÄ‚îÄ auth_service.dart      # JWT, login, logout, refresh
    ‚îú‚îÄ‚îÄ utils/
    ‚îÇ   ‚îî‚îÄ‚îÄ date_utils.dart        # formatTime() ‚Äî –∑–∞—Ä–∞–∑ –¥—É–±–ª—é—î—Ç—å—Å—è —É 2 –º—ñ—Å—Ü—è—Ö
    ‚îî‚îÄ‚îÄ config/
        ‚îî‚îÄ‚îÄ app_config.dart        # serverUrl –∑ .env (–∑–∞—Ä–∞–∑ hardcode)
```

---

## ‚öôÔ∏è –í–ê–ñ–õ–ò–í–Ü –ö–û–ù–°–¢–ê–ù–¢–ò

```dart
// main.dart
const String serverUrl = 'https://pproject-y.onrender.com';
bool firebaseAvailable = false; // –≥–ª–æ–±–∞–ª—å–Ω–∏–π —Ñ–ª–∞–≥ ‚Äî false –Ω–∞ Windows
```

```javascript
// server/index.js
const PORT = process.env.PORT || 3000;
const BUCKET_NAME = "project-y-8df27.firebasestorage.app";
// maxHttpBufferSize: 6e7  ‚Üê –ë–ê–ì–ò: –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π (60MB), —Ç—Ä–µ–±–∞ 10e6
```

---

## üé® –î–ò–ó–ê–ô–ù-–°–ò–°–¢–ï–ú–ê (theme.dart)

```dart
// –í—Å—ñ –∫–æ–ª—å–æ—Ä–∏ ‚Äî —Ç—ñ–ª—å–∫–∏ —á–µ—Ä–µ–∑ SignalColors, –Ω–µ —Ö–∞—Ä–¥–∫–æ–¥–∏—Ç–∏
SignalColors.primary        // #2B5CE6 ‚Äî –∞–∫—Ü–µ–Ω—Ç, –∫–Ω–æ–ø–∫–∏, –∞–∫—Ç–∏–≤–Ω–∞ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—è
SignalColors.appBackground  // #111113 ‚Äî —Ñ–æ–Ω scaffold
SignalColors.surface        // #1A1B1D ‚Äî AppBar, –∫–∞—Ä—Ç–∫–∏
SignalColors.elevated       // #252528 ‚Äî –º–æ–¥–∞–ª–∏, –∫–æ–Ω—Ç–µ–∫—Å—Ç-–º–µ–Ω—é
SignalColors.outgoing       // #2B5CE6 ‚Äî –º–æ—ó –±—É–ª—å–±–∞—à–∫–∏
SignalColors.incoming       // #2C2C2E ‚Äî —á—É–∂—ñ –±—É–ª—å–±–∞—à–∫–∏
SignalColors.textPrimary    // #FFFFFF
SignalColors.textSecondary  // #8E8E9A

// –í—Å—ñ —Ä–æ–∑–º—ñ—Ä–∏ ‚Äî —Ç—ñ–ª—å–∫–∏ —á–µ—Ä–µ–∑ AppSizes
AppSizes.navBarHeight       // 72
AppSizes.bubbleRadius       // 18
AppSizes.avatarRadiusMedium // 27
// —Ç–æ—â–æ...
```

---

## üî• FIRESTORE –°–¢–†–£–ö–¢–£–†–ê

```
users/{username}
  username, avatarUrl, createdAt
  [–ü–õ–ê–ù] passwordHash, bio, links[], online, lastSeen, isPremium

chats/{chatId}
  type: "dm" | "group"
  participants: [username1, username2]
  lastMessage: { text, sender, timestamp, read }
  [–ü–õ–ê–ù] name, avatarUrl, adminUsername (–¥–ª—è –≥—Ä—É–ø)
  [–ü–õ–ê–ù] pinnedMessage, autoDeleteAfter

chats/{chatId}/messages/{messageId}
  text, sender, senderAvatar, type, timestamp, read
  replyTo: { id, text, sender }
  reactions: { "‚ù§Ô∏è": ["user1"], "üëç": ["user2"] }
  edited, editedAt
  audioUrl, audioDuration   (–¥–ª—è voice)
  [–ü–õ–ê–ù] status: "sent"|"delivered"|"read"
  [–ü–õ–ê–ù] fileUrl, filename, fileSize, mimeType (–¥–ª—è docs)

fcm_tokens/{token}
  username, updatedAt
  [–ü–†–û–ë–õ–ï–ú–ê]: –Ω–µ –æ—á–∏—â–∞—é—Ç—å—Å—è –Ω–µ–≤–∞–ª—ñ–¥–Ω—ñ —Ç–æ–∫–µ–Ω–∏

[–ü–õ–ê–ù] stories/{storyId}
  authorUsername, mediaUrl, mediaType, text, createdAt, expiresAt
stories/{storyId}/views/{username}: viewedAt
```

---

## üîå SOCKET.IO –ü–û–î–Ü–á

### –ö–ª—ñ—î–Ω—Ç ‚Üí –°–µ—Ä–≤–µ—Ä
| –ü–æ–¥—ñ—è | –î–∞–Ω—ñ | –û–ø–∏—Å |
|-------|------|------|
| `join_chat` | chatId | –í—Ö—ñ–¥ —É –∫—ñ–º–Ω–∞—Ç—É |
| `leave_chat` | chatId | –í–∏—Ö—ñ–¥ |
| `send_message` | {chatId, text, sender, type, replyTo?, audioUrl?, audioDuration?} | –ù–∞–¥—ñ—Å–ª–∞—Ç–∏ |
| `delete_message` | {messageId, chatId} | –í–∏–¥–∞–ª–∏—Ç–∏ |
| `edit_message` | {messageId, newText, username, chatId} | –†–µ–¥–∞–≥—É–≤–∞—Ç–∏ |
| `add_reaction` | {messageId, emoji, username, chatId} | –†–µ–∞–∫—Ü—ñ—è (toggle) |
| `typing` | {username, chatId} | –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–∞–±–æ—Ä—É |
| `mark_read` | {chatId} | –ü–æ–∑–Ω–∞—á–∏—Ç–∏ –ø—Ä–æ—á–∏—Ç–∞–Ω–∏–º |
| `register_token` | {token, username} | FCM —Ç–æ–∫–µ–Ω |
| `request_history` | chatId | –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ 50 –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å (—Ç—ñ–ª—å–∫–∏ Windows) |
| `debug_log` | string | –õ–æ–≥ –∑ —Ç–µ–ª–µ—Ñ–æ–Ω—É |

### –°–µ—Ä–≤–µ—Ä ‚Üí –ö–ª—ñ—î–Ω—Ç
| –ü–æ–¥—ñ—è | –î–∞–Ω—ñ | –û–ø–∏—Å |
|-------|------|------|
| `receive_message` | messageData | –ù–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è |
| `load_history` | message[] | –Ü—Å—Ç–æ—Ä—ñ—è (Windows) |
| `message_deleted` | messageId | –í–∏–¥–∞–ª–µ–Ω–æ |
| `message_edited` | {messageId, newText, edited} | –í—ñ–¥—Ä–µ–¥–∞–≥–æ–≤–∞–Ω–æ |
| `reaction_updated` | {messageId, reactions} | –†–µ–∞–∫—Ü—ñ—ó –æ–Ω–æ–≤–ª–µ–Ω–æ |
| `display_typing` | {username, chatId} | –•—Ç–æ—Å—å –¥—Ä—É–∫—É—î |
| `message_read_update` | data | –ü—Ä–æ—á–∏—Ç–∞–Ω–æ |

---

## üåê REST API

| –ú–µ—Ç–æ–¥ | –ï–Ω–¥–ø–æ—ñ–Ω—Ç | –û–ø–∏—Å |
|-------|----------|------|
| POST | `/auth` | –í—Ö—ñ–¥/—Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—è {username, avatarUrl} ‚Üí {status, user} |
| POST | `/upload` | –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–æ—Ç–æ ‚Üí {url} |
| POST | `/upload-audio` | –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∞—É–¥—ñ–æ ‚Üí {url} |
| GET | `/search_users?q=&myUsername=` | –ü–æ—à—É–∫ —é–∑–µ—Ä—ñ–≤ |
| POST | `/get_or_create_dm` | {myUsername, otherUsername} ‚Üí {id, ...chat} |
| GET | `/get_user_chats?username=` | –°–ø–∏—Å–æ–∫ —á–∞—Ç—ñ–≤ (–¥–ª—è Windows) |
| GET | `/ping` | Health check |

### –ü–õ–ê–ù –Ω–æ–≤–∏—Ö –µ–Ω–¥–ø–æ—ñ–Ω—Ç—ñ–≤:
```
POST /auth            ‚Üí –¥–æ–¥–∞—Ç–∏ password, –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏ {token, refreshToken, user}
POST /refresh         ‚Üí {refreshToken} ‚Üí {token}
GET  /messages        ‚Üí ?chatId=&before=<timestamp>&limit=50  (–ø–∞–≥—ñ–Ω–∞—Ü—ñ—è)
POST /upload-file     ‚Üí –¥–æ–∫—É–º–µ–Ω—Ç–∏ PDF/DOCX/ZIP ‚Üí {url, filename, size, mimeType}
POST /create_group    ‚Üí {name, participants[], adminUsername}
GET  /users/:username ‚Üí —Ä–æ–∑—à–∏—Ä–µ–Ω–∏–π –ø—Ä–æ—Ñ—ñ–ª—å
PUT  /users/:username ‚Üí {bio, links}
POST /stories         ‚Üí {mediaUrl, mediaType, text}
GET  /stories         ‚Üí –∞–∫—Ç–∏–≤–Ω—ñ —Å—Ç–æ—Ä—ñ–∑ –∑–≥—Ä—É–ø–æ–≤–∞–Ω—ñ –ø–æ –∞–≤—Ç–æ—Ä—É
```

---

## ‚úÖ –©–û –†–ï–ê–õ–Ü–ó–û–í–ê–ù–û (17 —Ñ—É–Ω–∫—Ü—ñ–π)

- [x] –ü—Ä–∏–≤–∞—Ç–Ω—ñ —á–∞—Ç–∏ (DM) ‚Äî Firestore + Socket.IO rooms
- [x] –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è —á–µ—Ä–µ–∑ –Ω—ñ–∫–Ω–µ–π–º + –∞–≤–∞—Ç–∞—Ä
- [x] –ù–∞–¥—Å–∏–ª–∞–Ω–Ω—è —Ñ–æ—Ç–æ (Firebase Storage)
- [x] –ì–æ–ª–æ—Å–æ–≤—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è + Waveform –ø–ª–µ—î—Ä (audio_player_widget.dart)
- [x] –ó–∞–ø–∏—Å –≥–æ–ª–æ—Å—É –∑ –∞–Ω—ñ–º–∞—Ü—ñ—î—é (voice_recorder.dart + –≤–±—É–¥–æ–≤–∞–Ω–∏–π —É ChatScreen)
- [x] –†–µ–∞–∫—Ü—ñ—ó –Ω–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è (emoji toggle)
- [x] Reply (–≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è) + swipe-to-reply
- [x] –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Ç–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
- [x] Signal Dark UI (SignalColors + AppSizes)
- [x] –ü–ª–∞–≤–∞—é—á–∞ –æ–≤–∞–ª—å–Ω–∞ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—è (Telegram-—Å—Ç–∏–ª—å)
- [x] FCM Push Notifications (multicast ‚Äî —î –ë–ê–ì, –Ω–∞–¥—Å–∏–ª–∞—î –≤—Å—ñ–º)
- [x] Windows –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ (HTTP fallback + Socket.IO)
- [x] Shorebird OTA-–æ–Ω–æ–≤–ª–µ–Ω–Ω—è
- [x] Typing indicator –∑ –∞–Ω—ñ–º–∞—Ü—ñ—î—é –∫—Ä–∞–ø–æ–∫
- [x] –†–æ–∑–¥—ñ–ª—é–≤–∞—á—ñ –¥–∞—Ç + Scroll Date Overlay
- [x] –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–µ –º–µ–Ω—é Signal-—Å—Ç–∏–ª—å (blur overlay + —Ä–µ–∞–∫—Ü—ñ—ó)
- [x] –ü–æ—à—É–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

---

## üêõ –í–Ü–î–û–ú–Ü –ë–ê–ì–ò (–≤–∏–ø—Ä–∞–≤–∏—Ç–∏ –ø–µ—Ä—à–∏–º–∏)

### üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ñ:
1. **Push –≤—Å—ñ–º** ‚Äî `send_message` –Ω–∞–¥—Å–∏–ª–∞—î FCM –í–°–Ü–ú —é–∑–µ—Ä–∞–º, –Ω–µ —Ç—ñ–ª—å–∫–∏ —É—á–∞—Å–Ω–∏–∫–∞–º —á–∞—Ç—É. –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è: —á–∏—Ç–∞—Ç–∏ `chat.participants`, —Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ `fcm_tokens` –∑–∞ –Ω–∏–º–∏.
2. **–î—É–±–ª—ñ–∫–∞—Ç LoginScreen** ‚Äî —î —ñ –≤ `main.dart` —ñ –≤ `login_screen.dart`. –ü—Ä–∏–±—Ä–∞—Ç–∏ –∑ `main.dart`.
3. **–ù–µ–º–∞—î –ø–∞—Ä–æ–ª—è** ‚Äî –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è —Ç—ñ–ª—å–∫–∏ –ø–æ –Ω—ñ–∫–Ω–µ–π–º—É, –±—É–¥—å-—Ö—Ç–æ –º–æ–∂–µ –∑–∞–π—Ç–∏ –ø—ñ–¥ —á—É–∂–∏–º —ñ–º–µ–Ω–µ–º.
4. **Socket –±–µ–∑ auth** ‚Äî –±—É–¥—å-—Ö—Ç–æ –º–æ–∂–µ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—å —ñ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.

### üü† –í–∞–∂–ª–∏–≤—ñ:
5. **`main.dart` ~1400 —Ä—è–¥–∫—ñ–≤** ‚Äî ChatScreen, MessageBubble, SwipeToReply, TypingIndicator —Ç–æ—â–æ ‚Äî –≤—Å–µ –≤ –æ–¥–Ω–æ–º—É —Ñ–∞–π–ª—ñ.
6. **`serverUrl` hardcode** ‚Äî —Ç—Ä–µ–±–∞ —É `.env` —á–µ—Ä–µ–∑ `flutter_dotenv`.
7. **`maxHttpBufferSize = 6e7`** ‚Äî 60MB, DoS —Ä–∏–∑–∏–∫. –ó–º–µ–Ω—à–∏—Ç–∏ –¥–æ `10e6`.
8. **`fcm_tokens` –Ω–µ –æ—á–∏—â–∞—é—Ç—å—Å—è** ‚Äî –Ω–µ–≤–∞–ª—ñ–¥–Ω—ñ —Ç–æ–∫–µ–Ω–∏ –Ω–∞–∫–æ–ø–∏—á—É—é—Ç—å—Å—è.
9. **–ù–µ–º–∞—î graceful shutdown** ‚Äî `process.on('SIGTERM', ...)` –≤—ñ–¥—Å—É—Ç–Ω—ñ–π.
10. **`firebaseAvailable` ‚Äî –≥–ª–æ–±–∞–ª—å–Ω–∞ –∑–º—ñ–Ω–Ω–∞** ‚Äî –∑–∞–º—ñ–Ω–∏—Ç–∏ –Ω–∞ DI (get_it –∞–±–æ riverpod).

---

## üì± –û–°–û–ë–õ–ò–í–û–°–¢–Ü –ü–õ–ê–¢–§–û–†–ú

```dart
// Windows: Firebase/Firestore –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ñ
if (!firebaseAvailable) {
  // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ HTTP /get_user_chats —Ç–∞ Socket.IO request_history
  // _localMessages ‚Äî –ª–æ–∫–∞–ª—å–Ω–∏–π List –∑–∞–º—ñ—Å—Ç—å StreamBuilder
}

// Android/iOS: Firestore StreamBuilder (real-time)
// Firebase Messaging + Push Notifications
// Shorebird OTA (—Ç—ñ–ª—å–∫–∏ Android/iOS)
```

---

## üì¶ PUBSPEC –ó–ê–õ–ï–ñ–ù–û–°–¢–Ü (–∫–ª—é—á–æ–≤—ñ)

```yaml
socket_io_client: ^3.1.4
firebase_core: ^4.4.0
firebase_messaging: ^16.1.1
cloud_firestore: ^6.1.2
shorebird_code_push: ^2.0.5
image_picker: ^1.2.1
record: ^6.2.0          # –ó–∞–ø–∏—Å –∞—É–¥—ñ–æ
audioplayers: ^6.5.1    # –í—ñ–¥—Ç–≤–æ—Ä–µ–Ω–Ω—è –∞—É–¥—ñ–æ
audio_waveforms: ^2.0.2 # (—î –≤ pubspec, –∞–ª–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤–ª–∞—Å–Ω–∏–π painter)
just_audio: ^0.9.43
vibration: ^3.1.6       # Haptic –ø—Ä–∏ swipe-to-reply
permission_handler: ^12.0.1
path_provider: ^2.1.1
shared_preferences: ^2.5.4
http: ^1.6.0
```

---

## üóì –ü–õ–ê–ù –†–û–ó–í–ò–¢–ö–£ (–∫–æ—Ä–æ—Ç–∫–∏–π)

| –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç | –ó–∞–¥–∞—á–∞ | –ß–∞—Å |
|-----------|--------|-----|
| üî¥ –ó–ê–†–ê–ó | –í–∏–ø—Ä–∞–≤–∏—Ç–∏ push-—Ñ—ñ–ª—å—Ç—Ä –ø–æ —É—á–∞—Å–Ω–∏–∫–∞—Ö | 1 –¥–µ–Ω—å |
| üî¥ –ó–ê–†–ê–ó | –†–æ–∑–±–∏—Ç–∏ main.dart –Ω–∞ —Ñ–∞–π–ª–∏ | 2 –¥–Ω—ñ |
| üî¥ –ó–ê–†–ê–ó | –î–æ–¥–∞—Ç–∏ –ø–∞—Ä–æ–ª—å + JWT | 3 –¥–Ω—ñ |
| üü† –§–∞–∑–∞ 1 | Rate limiting, helmet, –≤–∞–ª—ñ–¥–∞—Ü—ñ—è | 1 —Ç–∏–∂–¥–µ–Ω—å |
| üü† –§–∞–∑–∞ 2 | –°—Ç–∞—Ç—É—Å–∏ ‚úì‚úì‚úì, –æ–Ω–ª–∞–π–Ω-—Å—Ç–∞—Ç—É—Å, –ø–∞–≥—ñ–Ω–∞—Ü—ñ—è | 2 —Ç–∏–∂–Ω—ñ |
| üü† –§–∞–∑–∞ 2 | –ü–µ—Ä–µ–¥–∞—á–∞ –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤, –≥—Ä—É–ø–æ–≤—ñ —á–∞—Ç–∏ | 3 —Ç–∏–∂–Ω—ñ |
| üü° –§–∞–∑–∞ 2 | WebRTC –¥–∑–≤—ñ–Ω–∫–∏ | 1 –º—ñ—Å—è—Ü—å |
| üü° –§–∞–∑–∞ 3 | –ü—Ä–æ—Ñ—ñ–ª—ñ, –°—Ç–æ—Ä—ñ–∑ | 1 –º—ñ—Å—è—Ü—å |
| üü° –§–∞–∑–∞ 4 | DevOps, Redis, CI/CD, —Ç–µ—Å—Ç–∏ | 1 –º—ñ—Å—è—Ü—å |
| ‚è≥ –§–∞–∑–∞ 5 | E2EE, –º–æ–Ω–µ—Ç–∏–∑–∞—Ü—ñ—è | 2026+ |

---

## üí° –Ø–ö –í–ò–ö–û–†–ò–°–¢–û–í–£–í–ê–¢–ò –¶–ï–ô –§–ê–ô–õ

```
–ù–æ–≤–∏–π —á–∞—Ç ‚Üí –≤—Å—Ç–∞–≤–∏—Ç–∏ CONTEXT.md ‚Üí –¥–æ–¥–∞—Ç–∏ –¢–Ü–õ–¨–ö–ò –ø–æ—Ç—Ä—ñ–±–Ω–∏–π —Ñ–∞–π–ª:

–ó–∞–¥–∞—á–∞: "–≤–∏–ø—Ä–∞–≤–∏—Ç–∏ push-—Ñ—ñ–ª—å—Ç—Ä"     ‚Üí –¥–æ–¥–∞—Ç–∏ server/index.js
–ó–∞–¥–∞—á–∞: "–¥–æ–¥–∞—Ç–∏ –ø–∞–≥—ñ–Ω–∞—Ü—ñ—é –≤ —á–∞—Ç—ñ"   ‚Üí –¥–æ–¥–∞—Ç–∏ main.dart (–∞–±–æ chat_screen.dart)
–ó–∞–¥–∞—á–∞: "–Ω–æ–≤—ñ –∫–æ–ª—å–æ—Ä–∏ —É —Ç–µ–º—ñ"        ‚Üí –¥–æ–¥–∞—Ç–∏ theme.dart
–ó–∞–¥–∞—á–∞: "–ø—Ä–æ–±–ª–µ–º–∞ –∑ –∞—É–¥—ñ–æ –ø–ª–µ—î—Ä–æ–º"  ‚Üí –¥–æ–¥–∞—Ç–∏ audio_player_widget.dart
–ó–∞–¥–∞—á–∞: "—Ä–æ–∑–±–∏—Ç–∏ main.dart"         ‚Üí –¥–æ–¥–∞—Ç–∏ main.dart
–ó–∞–¥–∞—á–∞: "—â–æ—Å—å –Ω–µ —Ç–∞–∫ —É –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó"   ‚Üí –¥–æ–¥–∞—Ç–∏ home_screen.dart
```